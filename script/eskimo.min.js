(function(){var e=this,j=e._,h={},g=Array.prototype,k=Object.prototype,i=g.slice,v=g.unshift,s=k.toString,n=k.hasOwnProperty,t=g.forEach,y=g.map,m=g.reduce,p=g.reduceRight,q=g.filter,z=g.every,A=g.some,u=g.indexOf,B=g.lastIndexOf,k=Array.isArray,E=Object.keys,w=Function.prototype.bind,b=function(a){return new o(a)};typeof module!=="undefined"&&module.exports?(module.exports=b,b._=b):e._=b;b.VERSION="1.1.7";var l=b.each=b.forEach=function(a,c,b){if(a!=null)if(t&&a.forEach===t)a.forEach(c,b);else if(a.length===
+a.length)for(var f=0,r=a.length;f<r;f++){if(f in a&&c.call(b,a[f],f,a)===h)break}else for(f in a)if(n.call(a,f)&&c.call(b,a[f],f,a)===h)break};b.map=function(a,c,b){var f=[];if(a==null)return f;if(y&&a.map===y)return a.map(c,b);l(a,function(a,F,e){f[f.length]=c.call(b,a,F,e)});return f};b.reduce=b.foldl=b.inject=function(a,c,d,f){var r=d!==void 0;a==null&&(a=[]);if(m&&a.reduce===m)return f&&(c=b.bind(c,f)),r?a.reduce(c,d):a.reduce(c);l(a,function(a,b,e){r?d=c.call(f,d,a,b,e):(d=a,r=!0)});if(!r)throw new TypeError("Reduce of empty array with no initial value");
return d};b.reduceRight=b.foldr=function(a,c,d,f){a==null&&(a=[]);if(p&&a.reduceRight===p)return f&&(c=b.bind(c,f)),d!==void 0?a.reduceRight(c,d):a.reduceRight(c);a=(b.isArray(a)?a.slice():b.toArray(a)).reverse();return b.reduce(a,c,d,f)};b.find=b.detect=function(a,c,b){var f;C(a,function(a,e,g){if(c.call(b,a,e,g))return f=a,!0});return f};b.filter=b.select=function(a,c,b){var f=[];if(a==null)return f;if(q&&a.filter===q)return a.filter(c,b);l(a,function(a,e,g){c.call(b,a,e,g)&&(f[f.length]=a)});return f};
b.reject=function(a,c,b){var f=[];if(a==null)return f;l(a,function(a,e,g){c.call(b,a,e,g)||(f[f.length]=a)});return f};b.every=b.all=function(a,c,b){var f=!0;if(a==null)return f;if(z&&a.every===z)return a.every(c,b);l(a,function(a,e,g){if(!(f=f&&c.call(b,a,e,g)))return h});return f};var C=b.some=b.any=function(a,c,d){var c=c||b.identity,f=!1;if(a==null)return f;if(A&&a.some===A)return a.some(c,d);l(a,function(a,b,e){if(f|=c.call(d,a,b,e))return h});return!!f};b.include=b.contains=function(a,c){var b=
!1;if(a==null)return b;if(u&&a.indexOf===u)return a.indexOf(c)!=-1;C(a,function(a){if(b=a===c)return!0});return b};b.invoke=function(a,c){var d=i.call(arguments,2);return b.map(a,function(a){return(c.call?c||a:a[c]).apply(a,d)})};b.pluck=function(a,c){return b.map(a,function(a){return a[c]})};b.max=function(a,c,d){if(!c&&b.isArray(a))return Math.max.apply(Math,a);var f={computed:-Infinity};l(a,function(a,b,e){b=c?c.call(d,a,b,e):a;b>=f.computed&&(f={value:a,computed:b})});return f.value};b.min=function(a,
c,d){if(!c&&b.isArray(a))return Math.min.apply(Math,a);var f={computed:Infinity};l(a,function(a,b,e){b=c?c.call(d,a,b,e):a;b<f.computed&&(f={value:a,computed:b})});return f.value};b.sortBy=function(a,c,d){return b.pluck(b.map(a,function(a,b,e){return{value:a,criteria:c.call(d,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};b.groupBy=function(a,b){var d={};l(a,function(a,e){var g=b(a,e);(d[g]||(d[g]=[])).push(a)});return d};b.sortedIndex=function(a,c,d){d||
(d=b.identity);for(var f=0,e=a.length;f<e;){var g=f+e>>1;d(a[g])<d(c)?f=g+1:e=g}return f};b.toArray=function(a){return!a?[]:a.toArray?a.toArray():b.isArray(a)?i.call(a):b.isArguments(a)?i.call(a):b.values(a)};b.size=function(a){return b.toArray(a).length};b.first=b.head=function(a,b,d){return b!=null&&!d?i.call(a,0,b):a[0]};b.rest=b.tail=function(a,b,d){return i.call(a,b==null||d?1:b)};b.last=function(a){return a[a.length-1]};b.compact=function(a){return b.filter(a,function(a){return!!a})};b.flatten=
function(a){return b.reduce(a,function(a,d){if(b.isArray(d))return a.concat(b.flatten(d));a[a.length]=d;return a},[])};b.without=function(a){return b.difference(a,i.call(arguments,1))};b.uniq=b.unique=function(a,c){return b.reduce(a,function(a,f,e){if(0==e||(c===!0?b.last(a)!=f:!b.include(a,f)))a[a.length]=f;return a},[])};b.union=function(){return b.uniq(b.flatten(arguments))};b.intersection=b.intersect=function(a){var c=i.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,
function(c){return b.indexOf(c,a)>=0})})};b.difference=function(a,c){return b.filter(a,function(a){return!b.include(c,a)})};b.zip=function(){for(var a=i.call(arguments),c=b.max(b.pluck(a,"length")),d=Array(c),f=0;f<c;f++)d[f]=b.pluck(a,""+f);return d};b.indexOf=function(a,c,d){if(a==null)return-1;var f;if(d)return d=b.sortedIndex(a,c),a[d]===c?d:-1;if(u&&a.indexOf===u)return a.indexOf(c);d=0;for(f=a.length;d<f;d++)if(a[d]===c)return d;return-1};b.lastIndexOf=function(a,b){if(a==null)return-1;if(B&&
a.lastIndexOf===B)return a.lastIndexOf(b);for(var d=a.length;d--;)if(a[d]===b)return d;return-1};b.range=function(a,b,d){arguments.length<=1&&(b=a||0,a=0);for(var d=arguments[2]||1,f=Math.max(Math.ceil((b-a)/d),0),e=0,g=Array(f);e<f;)g[e++]=a,a+=d;return g};b.bind=function(a,b){if(a.bind===w&&w)return w.apply(a,i.call(arguments,1));var d=i.call(arguments,2);return function(){return a.apply(b,d.concat(i.call(arguments)))}};b.bindAll=function(a){var c=i.call(arguments,1);c.length==0&&(c=b.functions(a));
l(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,c){var d={};c||(c=b.identity);return function(){var b=c.apply(this,arguments);return n.call(d,b)?d[b]:d[b]=a.apply(this,arguments)}};b.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(i.call(arguments,1)))};var D=function(a,b,d){var f;return function(){var e=this,g=arguments,h=function(){f=null;a.apply(e,g)};d&&clearTimeout(f);
if(d||!f)f=setTimeout(h,b)}};b.throttle=function(a,b){return D(a,b,!1)};b.debounce=function(a,b){return D(a,b,!0)};b.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;return d=a.apply(this,arguments)}};b.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments));return b.apply(this,d)}};b.compose=function(){var a=i.call(arguments);return function(){for(var b=i.call(arguments),d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};b.after=function(a,b){return function(){if(--a<
1)return b.apply(this,arguments)}};b.keys=E||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)n.call(a,d)&&(b[b.length]=d);return b};b.values=function(a){return b.map(a,b.identity)};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()};b.extend=function(a){l(i.call(arguments,1),function(b){for(var d in b)b[d]!==void 0&&(a[d]=b[d])});return a};b.defaults=function(a){l(i.call(arguments,1),function(b){for(var d in b)a[d]==
null&&(a[d]=b[d])});return a};b.clone=function(a){return b.isArray(a)?a.slice():b.extend({},a)};b.tap=function(a,b){b(a);return a};b.isEqual=function(a,c){if(a===c)return!0;var d=typeof a;if(d!=typeof c)return!1;if(a==c)return!0;if(!a&&c||a&&!c)return!1;if(a._chain)a=a._wrapped;if(c._chain)c=c._wrapped;if(a.isEqual)return a.isEqual(c);if(c.isEqual)return c.isEqual(a);if(b.isDate(a)&&b.isDate(c))return a.getTime()===c.getTime();if(b.isNaN(a)&&b.isNaN(c))return!1;if(b.isRegExp(a)&&b.isRegExp(c))return a.source===
c.source&&a.global===c.global&&a.ignoreCase===c.ignoreCase&&a.multiline===c.multiline;if(d!=="object")return!1;if(a.length&&a.length!==c.length)return!1;var d=b.keys(a),f=b.keys(c);if(d.length!=f.length)return!1;for(var e in a)if(!(e in c)||!b.isEqual(a[e],c[e]))return!1;return!0};b.isEmpty=function(a){if(b.isArray(a)||b.isString(a))return a.length===0;for(var c in a)if(n.call(a,c))return!1;return!0};b.isElement=function(a){return!!(a&&a.nodeType==1)};b.isArray=k||function(a){return s.call(a)==="[object Array]"};
b.isObject=function(a){return a===Object(a)};b.isArguments=function(a){return!(!a||!n.call(a,"callee"))};b.isFunction=function(a){return!(!a||!a.constructor||!a.call||!a.apply)};b.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)};b.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)};b.isNaN=function(a){return a!==a};b.isBoolean=function(a){return a===!0||a===!1};b.isDate=function(a){return!(!a||!a.getTimezoneOffset||!a.setUTCFullYear)};b.isRegExp=function(a){return!(!a||
!a.test||!a.exec||!(a.ignoreCase||a.ignoreCase===!1))};b.isNull=function(a){return a===null};b.isUndefined=function(a){return a===void 0};b.noConflict=function(){e._=j;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var f=0;f<a;f++)b.call(d,f)};b.mixin=function(a){l(b.functions(a),function(c){G(c,b[c]=a[c])})};var H=0;b.uniqueId=function(a){var b=H++;return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};b.template=function(a,c){var d=
b.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",d=new Function("obj",d);return c?d(c):d};var o=function(a){this._wrapped=
a};b.prototype=o.prototype;var x=function(a,c){return c?b(a).chain():a},G=function(a,c){o.prototype[a]=function(){var a=i.call(arguments);v.call(a,this._wrapped);return x(c.apply(b,a),this._chain)}};b.mixin(b);l(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=g[a];o.prototype[a]=function(){b.apply(this._wrapped,arguments);return x(this._wrapped,this._chain)}});l(["concat","join","slice"],function(a){var b=g[a];o.prototype[a]=function(){return x(b.apply(this._wrapped,arguments),
this._chain)}});o.prototype.chain=function(){this._chain=!0;return this};o.prototype.value=function(){return this._wrapped}})();Eskimo=function(e){function j(e,g){s(e.documentElement).bind({keydown:function(e){typeof g.keydown!=="undefined"&&g.keydown(e)},keyup:function(e){typeof g.keyup!=="undefined"&&g.keyup(e)}})}var e=e||{},h=e.scheduler||Eskimo.Scheduler,g=e.gameLoop||Eskimo.FixedGameLoop,k=e.assets||Eskimo.Assets,i=e.drawer||Eskimo.Drawer,v=e.updater,s=e.jquery,n=Eskimo.Screen,t;return{start:function(e){t=new h(e.FRAME_RATE||60);var m=new k(s,"IMG"),p=new k(s,"audio"),q=new i(new n(e.canvas,m)),p=Eskimo.Jukebox(p),m=
new v({images:m,jukebox:p}),q=new g(t,m,q);j(e.document,m);q.start()}}};Eskimo.Assets=function(e,j){var h={};this.get=function(e){return h[e]&&h[e].loaded?h[e].get(0):null};this.load=function(g,k){if(h[g])throw{name:"Eskimo.AssetAlreadyExists",message:"Asset '"+k+"' already exists"};else h[g]=e("<"+j+" src='"+k+"'>"),h[g].load(function(){h[g].loaded=!0})}};Eskimo.Drawer=function(e){this.draw=function(j){e.clear();_(j).each(function(h){e.drawImage(h.name,h.location.x,h.location.y)})}};Eskimo.FixedGameLoop=function(e,j,h){var g=e.getTicks(),k;this.loop=function(){for(;e.getTicks()>g;)k=[],j.update(k),g+=e.getTickTime();h.draw(k)};this.stop=function(){e.stop()};this.start=function(){e.start(this.loop)}};Eskimo.KeyCodes={RIGHT_ARROW:39,LEFT_ARROW:37,SPACEBAR:32};Eskimo.Point=function(e,j){return Eskimo.Vector.create2DVector(e,j)};Eskimo.random=function(){return Math.random()};Eskimo.Scheduler=function(e){var j;this.start=function(e){j=setInterval(function(){e()},this.getTickTime())};this.stop=function(){clearInterval(j)};this.getTickTime=function(){return 1E3/e}};Eskimo.Scheduler.prototype.getTicks=function(){return(new Date).getTime()};Eskimo.Screen=function(e,j){var h=e[0].getContext("2d");this.assets=j;this.drawImage=function(e,k,i){j.get(e)&&h.drawImage(j.get(e),k,i)};this.clear=function(){h.fillStyle=Eskimo.Screen.BACKGROUND_COLOR;h.fillRect(0,0,e.width(),e.height())}};Eskimo.Screen.BACKGROUND_COLOR="#aaaabb";Eskimo.Jukebox=function(e){return{assets:e,play:function(e){this.assets.get(e).play()}}};Eskimo.Vector={create2DVector:function(e,j){return{x:e,y:j,lengthSquared:e*e+j*j,normalized:function(){var e=Math.sqrt(this.lengthSquared);return Eskimo.Vector.create2DVector(this.x/e,this.y/e)},scaled:function(e){var g=this.normalized();return Eskimo.Vector.create2DVector(g.x*e,g.y*e)}}}};
